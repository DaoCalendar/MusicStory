<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link rel="stylesheet" href="/layui/css/layui.css">
    <link rel="stylesheet" href="/css/public.css">
</head>
<body class="child-body">
<div class="child-nav">
    <span class="layui-breadcrumb">
         <a>系统设置</a>
         <a><cite>角色列表</cite></a>
    </span>
    <a class="layui-btn layui-btn-sm" href="javascript:location.replace(location.href);" title="刷新" style="float:right;margin-top: 3px"><i class="layui-icon" style="line-height:30px">&#x1002;</i></a>
</div>

<div class="layui-row">
    <form  class="layui-form" th:action="@{/sys/adminList}">
        <div class="layui-form-item search-row">
            <div class="layui-inline">
                <label class="search-label">角色名</label>
                <div class="search-input">
                    <input type="text" name="username" class="layui-input">
                </div>
            </div>
            <div class="layui-inline">
                <label class="search-label">角色类型</label>
                <div class="search-input">
                    <select name="gender">
                        <option value=""></option>
                        <option value="1">后台角色</option>
                        <option value="2">前台角色</option>
                    </select>
                </div>
            </div>
            <div class="layui-inline">
                <label class="search-label">是否可用</label>
                <div class="search-input">
                    <select name="state">
                        <option value=""></option>
                        <option value="0">停用</option>
                        <option value="1">正常</option>
                    </select>
                </div>
            </div>
            <div class="layui-inline">
                <button class="layui-btn" lay-submit lay-filter="search"><i class="layui-icon">&#xe615;</i>查询</button>
            </div>
            <div class="layui-inline">
                <a href="#" type="button" class="layui-btn"><i class="layui-icon">&#xe608;</i>新增</a>
            </div>
        </div>
        <input type="hidden" name="page" id="pg">
        <input type="hidden" name="size" id="se">
    </form>
</div>

<table class="layui-table" lay-filter="roles">
    <thead>
    <tr>
        <th lay-data="{field:'role', sort:true}">角色名</th>
        <th lay-data="{field:'description'}">角色描述</th>
        <th lay-data="{field:'roleType'}">角色类型</th>
        <th lay-data="{field:'available'}">是否可用</th>
        <th lay-data="{field:'opt'}">操作</th>
    </tr>
    </thead>
    <tbody>
    <tr th:each="role:${roleList}">
        <td th:text="${role.role}"></td>
        <td th:text="${role.description}"></td>
        <td th:text="${#strings.equals(role.roleType,'1')?'后台角色':'前台角色'}"></td>
        <td th:text="${#bools.isTrue(role.available)?'可用':'停用'}"></td>
        <td>
            <a class="layui-btn layui-btn-xs" th:attr="data-id=${role.id}" href="javascript:void(0);"><i class="layui-icon iconfont icon-view"></i>详情</a>
            <a class="layui-btn layui-btn-xs" th:attr="data-id=${role.id}" href="javascript:void(0);"><i class="layui-icon">&#xe642;</i>编辑</a>
            <a sec:authorize="hasAuthority('admin')" class="layui-btn layui-btn-danger layui-btn-xs" th:attr="data-id=${role.id}" href="javascript:void(0);"><i class="layui-icon">&#xe640;</i>删除</a>
        </td>
    </tr>
    </tbody>
</table>
<div id="pag"></div>
<script src="/layui/layui.js"></script>
<script type="text/javascript">
    layui.use(['element','laypage','table','laydate'], function(){
        $ = layui.jquery;

        /*<![CDATA[*/
        var ct = [[${roleList.totalElements}]];
        var cn = [[${roleList.number+1}]];
        var ns = [[${roleList.size}]];
        /*]]>*/

        var table = layui.table;
        //转换静态表格
        table.init('roles', {
            limit: ns //注意：请务必确保 limit 参数（默认：10）是与你服务端限定的数据条数一致
        });

        var laypage = layui.laypage;
        //执行一个laypage实例
        laypage.render({
            elem: 'pag', //注意，这里的ID，不用加 # 号
            count:ct, //数据总数，从服务端得到
            groups:10,
            limit:ns,
            // limits:[10, 20, 30, 40, 50],
            curr:cn,
            layout:['prev', 'page', 'next','skip','count','limit'],
            jump: function(obj,first){
                if(!first){
                    $('#pg').val(obj.curr-1);
                    $('#se').val(obj.limit);
                    $('form').submit();
                    // url+="?page="+(obj.curr-1)+"&size="+obj.limit;
                    // window.location.href=url;
                }
            }
        });

        var laydate = layui.laydate;
        //执行一个laydate实例
        laydate.render({
            elem: '#bt', //指定元素
            type: 'datetime',
            max:0
        });
        laydate.render({
            elem: '#et', //指定元素
            type: 'datetime',
            max:0
        });
    });
</script>
</body>
</html>