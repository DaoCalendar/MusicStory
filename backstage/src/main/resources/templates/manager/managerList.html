<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
      xmlns:javascript="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <title>管理员列表</title>
    <link rel="stylesheet" href="/layui/css/layui.css">
    <link rel="stylesheet" href="/css/public.css">
</head>
<body class="child-body">

<div class="child-nav">
    <span class="layui-breadcrumb">
         <a>系统设置</a>
         <a><cite>管理员列表</cite></a>
    </span>
    <a class="layui-btn layui-btn-sm" href="javascript:location.replace(location.href);" title="刷新" style="float:right;margin-top: 3px"><i class="layui-icon" style="line-height:30px">&#x1002;</i></a>
</div>

<div class="layui-row">
    <form  class="layui-form" th:action="@{/sys/adminList}">
        <div class="layui-form-item">
            <div class="layui-inline">
                <label class="layui-form-label">用户名</label>
                <div class="layui-input-inline">
                    <input type="text" name="username" class="layui-input" th:value="${manger.username}">
                </div>
            </div>
            <div class="layui-inline">
                <label class="layui-form-label">创建时间</label>
                <div class="layui-input-inline">
                    <input type="text" name="beginTime" id="bt" class="layui-input" th:value="${manger.beginTime}">
                </div>
                <div class="layui-form-mid">-</div>
                <div class="layui-input-inline">
                    <input type="text" name="endTime" id="et" class="layui-input" th:value="${manger.endTime}">
                </div>
            </div>
            <div class="layui-inline">
                <label class="layui-form-label">性别</label>
                <div class="layui-input-block">
                    <select name="gender">
                        <option value=""></option>
                        <option value="1" th:selected="${manger.gender==1}">男</option>
                        <option value="2" th:selected="${manger.gender==2}">女</option>
                    </select>
                </div>
            </div>
            <div class="layui-inline">
                <label class="layui-form-label">状态</label>
                <div class="layui-input-block">
                    <select name="state">
                        <option value=""></option>
                        <option value="0">初始化</option>
                        <option value="1" th:selected="${manger.state==1}">正常</option>
                        <option value="2" th:selected="${manger.state==2}">封禁</option>
                    </select>
                </div>
            </div>
            <div class="layui-inline">
                <div class="layui-input-block">
                    <button class="layui-btn layui-btn-sm" lay-submit lay-filter="search"><i class="layui-icon">&#xe615;</i>查询</button>
                </div>
            </div>
        </div>
        <input type="hidden" name="page" id="pg">
        <input type="hidden" name="size" id="se">
    </form>
</div>

<table class="layui-table" lay-filter="managers">
    <thead>
    <tr>
        <th lay-data="{field:'username', sort:true}">用户名</th>
        <th lay-data="{field:'realName'}">真实姓名</th>
        <th lay-data="{field:'gender'}">性别</th>
        <th lay-data="{field:'birthday'}">生日</th>
        <th lay-data="{field:'state'}">状态</th>
        <th lay-data="{field:'createTime', sort:true}">创建时间</th>
        <th lay-data="{field:'updateTime', sort:true}">修改时间</th>
        <th lay-data="{field:'opt'}">操作</th>
    </tr>
    </thead>
    <tbody>
    <tr th:each="manager:${managerList}" th:switch="${manager.state}">
        <td th:text="${manager.username}"></td>
        <td th:text="${manager.realName}"></td>
        <td th:text="${#strings.equals(manager.gender,'1')?'男':'女'}"></td>
        <td th:text="${#dates.format(manager.birthday, 'yyyy-MM-dd')}"></td>
        <td th:case="'0'">初始化</td><td th:case="'1'">正常</td><td th:case="'2'">封禁</td><td th:case="*"></td>
        <td th:text="${manager.createTime}"></td>
        <td th:text="${manager.updateTime}"></td>
        <td><a sec:authorize="hasAuthority('admin')" class="remove" th:attr="data-id=${manager.id}" href="javascript:void(0);">删除</a></td>
    </tr>
    </tbody>
</table>
<div id="pag"></div>
<script src="/layui/layui.js"></script>
<script type="text/javascript">
    layui.use(['element','laypage','table','laydate'], function(){
        $ = layui.jquery;

        /*<![CDATA[*/
        var ct = [[${managerList.totalElements}]];
        var cn = [[${managerList.number+1}]];
        var ns = [[${managerList.size}]];
        /*]]>*/

        var table = layui.table;
        //转换静态表格
        table.init('managers', {
            limit: ns //注意：请务必确保 limit 参数（默认：10）是与你服务端限定的数据条数一致
        });

        var laypage = layui.laypage;
        //执行一个laypage实例
        laypage.render({
            elem: 'pag', //注意，这里的ID，不用加 # 号
            count:ct, //数据总数，从服务端得到
            groups:10,
            limit:ns,
            // limits:[10, 20, 30, 40, 50],
            curr:cn,
            layout:['prev', 'page', 'next','skip','count','limit'],
            jump: function(obj,first){
                if(!first){
                    $('#pg').val(obj.curr-1);
                    $('#se').val(obj.limit);
                    $('form').submit();
                    // url+="?page="+(obj.curr-1)+"&size="+obj.limit;
                    // window.location.href=url;
                }
            }
        });

        var laydate = layui.laydate;
        //执行一个laydate实例
        laydate.render({
            elem: '#bt', //指定元素
            type: 'datetime',
            max:0
        });
        laydate.render({
            elem: '#et', //指定元素
            type: 'datetime',
            max:0
        });
    });
</script>
</body>
</html>